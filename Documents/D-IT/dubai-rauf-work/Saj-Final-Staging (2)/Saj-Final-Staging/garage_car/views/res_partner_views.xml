<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Inherit res.partner and added new car history tab -->
        <record id="view_partner_form_inherit" model="ir.ui.view">
            <field name="name">res.partner.form</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">
                <xpath expr="//form/sheet" position="before">
                    <header>
                        <button name="create_inspection" type="object"
                            string="Create Inspection" class="oe_highlight"/>
                        <button name="create_estimation" type="object"
                            string="Create Estimation" class="oe_highlight"/>
                        <button name="create_invoice" type="object"
                            string="Create Invoice" class="oe_highlight"/>
                    </header>
                </xpath>
                <xpath expr="//form/sheet/notebook/page[@name='internal_notes']" position="after">
                    <page name="car_histories" string="Service Cars">
                        <field name="car_line" mode="kanban">
                            <kanban default_group_by="car_brand_id" sample="1">
                                <field name="car_brand_id"/>
                                <field name="car_model_id"/>
                                <field name="year"/>
                                <field name="plate_number"/>
                                <field name="vin_number"/>
                                <field name="door"/>
                                <field name="gear_type_id"/>
                                <field name="gear_box_id"/>
                                <field name="color_id"/>
                                <field name="cylinder_id"/>
                                <field name="spec_id"/>
                                <field name="engine_cc"/>
                                <field name="image_128"/>
                                <!-- <progressbar field="activity_state" colors='{"planned": "success", "today": "warning", "overdue": "danger"}'/>-->

                                <templates>
                                    <t t-name="kanban-box">
                                        <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                                            <!-- <div class="oe_resource_image">
                                                <img  t-att-src="kanban_image('car.history','image_128',record.id.raw_value)"  class="oe_resource_picture"/>
                                            </div>-->
                                            
                                            <div class="oe_kanban_details">
                                                <strong class="o_kanban_record_plate_number">
                                                    <t t-if="record.plate_number.raw_value">Plate Number:</t> <field name="plate_number"/>
                                                </strong><br/>
                                                <div class="o_kanban_record_title_model">
                                                    <t t-if="record.car_model_id.raw_value">Model:</t> <field name="car_model_id"/>
                                                </div>
                                                <div class="o_kanban_tags_section">
                                                    <t t-if="record.color_id.raw_value">Color: </t> <field name="color_id"/>,  <t t-if="record.year.raw_value">Year: <field name="year"/></t>
                                                </div>
                                                <ul>
                                                    <li>
                                                        <t t-if="record.spec_id.raw_value">Spec: <field name="spec_id"/></t>
                                                    </li>
                                                    <li>
                                                        <t t-if="record.vin_number.raw_value">Vin Number: <field name="vin_number"/></t>
                                                    </li>
                                                    <!-- <li>
                                                        <t t-if="record.year.raw_value">Year: <field name="year"/></t>
                                                    </li>-->
                                                </ul>
                                                
                                            </div>
                                        </div>
                                    </t>
                                </templates>
                            </kanban>
                            <tree string="Services Car" editable="bottom">
                                <field name="car_brand_id"/>
                                <field name="car_model_id" domain="[('brand_id', '=', car_brand_id)]"/>
                                <field name="year"/>
                                <field name="plate_number"/>
                                <field name="vin_number"/>
                                <field name="door"/>
                                <field name="gear_type_id"/>
                                <field name="gear_box_id"/>
                                <field name="color_id"/>
                                <field name="cylinder_id"/>
                                <field name="spec_id"/>
                                <field name="engine_cc"/>
<!--                                <field name="udf"/>-->
                            </tree>
                            <form string="Services Car">
                                <sheet>
                                    <div class="oe_title">
                                        <h1>
                                            <field name="name" readonly="1"/>
                                        </h1>
                                    </div>
                                    <group>
                                        <group>
                                            <field name="car_brand_id"/>
                                            <field name="car_model_id" domain="[('brand_id', '=', car_brand_id)]"/>
                                            <field name="year"/>
                                            <field name="plate_number"/>
                                            <field name="vin_number"/>
                                            <field name="door"/>
                                            <field name="engine_cc"/>
                                        </group>
                                        <group>
                                            <field name="gear_type_id"/>
                                            <field name="gear_box_id"/>
                                            <field name="color_id"/>
                                            <field name="cylinder_id"/>
                                            <field name="spec_id"/>
                                            <field name="social_reference_id"/>
<!--                                            <field name="udf"/>-->
                                        </group>
                                    </group>
                                </sheet>
                            </form>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>
        
    </data>
</odoo>
            
            
            