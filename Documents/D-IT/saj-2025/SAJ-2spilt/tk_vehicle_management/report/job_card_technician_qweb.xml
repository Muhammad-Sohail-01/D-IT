<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="estimation_inspection_report" inherit_id="sale.report_saleorder_document">
            <xpath expr="//t[@t-call='web.external_layout']" position="replace">
                <t t-call="web.basic_layout">
                    <t t-foreach="docs" t-as="doc">
                        <style>
                            .page {
                                padding: 0 !important;
                                margin: 0 !important;
                            }
                            .header, .footer {
                                display: none !important;
                            }
                            .container {
                                width: 100% !important;
                                max-width: none !important;
                                padding: 0 !important;
                                margin: 0 !important;
                            }
                            .service-header {
                                background-color: #73b957;
                                color: white;
                                padding: 8px;
                            }
                            .table-header {
                                background-color: #bcbcbc;
                                color: white;
                            }
                            @media print {
                                .service-header, .table-header {
                                    -webkit-print-color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                }
                            }
                        </style>

                        <div class="page" t-att-style="'background: url({}); background-size:1200px 1700px; width:1200px; height:1700px;'.format(image_data_uri(doc.company_id.print_template))">
                            <!-- Title Section -->
                            <div class="row" style="margin-top: 60mm; padding-top: 30px;">
                                <div class="col-12 text-center">
                                    <h1>JOB CARD</h1>
                                </div>
                            </div>

                            <!-- Customer and Vehicle Details -->
                            <div class="row mb-4" style="padding-left:35px; padding-right: 20px; font-size: 22px;">
                                <div class="col-4">
                                    <strong class="d-block mb-2">Customer Details</strong>
                                    <div>Name: <span t-field="doc.sale_order_id.partner_id.name"/></div>
                                    <div>Job Card No.: <span t-field="doc.name"/></div>
                                    <div>Advisor: <span t-field="doc.service_adviser_id.name"/></div>
                                </div>
                                <div class="col-4 text-center">
                                    <div t-field="doc.brand_id" style="font-weight: bold;"/>
                                    <div>Model: <span t-field="doc.vehicle_model_id.name"/></div>
                                    <div>Year: <span t-field="doc.year"/></div>
                                    <div>Plate: <span t-field="doc.registration_no"/></div>
                                    <div>VIN: <span t-field="doc.vin_no"/></div>
                                </div>
                                <div class="col-4 text-end">
                                    <div>Date: <span t-field="doc.sale_order_id.date_order"/></div>
                                    <div>ODO: <span t-field="doc.miles"/></div>
                                    <div>Receptionist: <span t-field="doc.sale_person_id.name"/></div>
                                </div>
                            </div>

                            <!-- Products/Services Table -->
                            <div class="mt-4" style="margin-left: 3mm; margin-right: 3mm; padding-left:32px; padding-right: 10px;">
<!--                                <h4 class="service-header">Services &amp; Parts</h4>-->
                                <table class="table table-bordered">
                                    <thead class="table-header">
                                        <tr>
                                            <th width="15%">CATEGORY</th>
                                            <th width="35%">ITEM</th>
                                            <th width="30%">Description</th>
                                            <th width="5%">Warranty</th>
                                            <th width="10%" class="text-end">QTY</th>
                                            <th width="10%" class="text-end">UoM</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="doc.sale_order_id.order_line" t-as="line">
                                            <t t-if="not line.display_type">
                                                <td><span t-field="line.product_id.categ_id.name"/></td>
                                                <td><span t-field="line.name"/></td>
                                                <td>
                                                    <span t-field="line.name"/><br/>
                                                    <t t-if="line.is_warranty">
                                                        <span style="font-weight: bold;">*Warranty Validation Upto </span>
                                                        <span style="font-weight: bold;" t-field="line.warranty_expiry_date"/>
                                                    </t>
                                                </td>
                                                <td class="text-center">
                                                    <t t-if="line.is_warranty">
                                                        <input type="checkbox" checked="checked" style="width: 20px; height: 20px;"/>
                                                    </t>
                                                </td>
                                                <td class="text-end"><span t-field="line.product_uom_qty"/></td>
                                                <td class="text-end"><span t-field="line.product_uom.name"/></td>
                                            </t>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Comments and Signature Section -->
                            <div class="row mt-5" style="margin-left: 15mm; margin-right: 15mm;">
                                <div class="col-6">
                                    <h4>Comments/Remarks:</h4>
                                    <div style="min-height: 100px;"></div>
                                </div>
                                <div class="col-6">
                                    <h4>Customer Signature:</h4>
                                    <div style="min-height: 100px; border-top: 1px solid #000;" class="mt-5"></div>
                                </div>
                            </div>

                            <!-- Footer -->
                            <div class="footer" style="margin-top: 20px;">
                                <hr style="border: 2px solid #73b957;"/>
                            </div>
                        </div>
                    </t>
                </t>
            </xpath>
        </template>

        <!-- Paper Format -->
        <record id="custom_paperformat_quotation" model="report.paperformat">
            <field name="name">EVS Invoice A4</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="page_height">0</field>
	        <field name="page_width">0</field>
	        <field name="orientation">Portrait</field>
	        <field name="margin_top">3</field>
	        <field name="margin_bottom">3</field>
	        <field name="margin_left">3</field>
	        <field name="margin_right">3</field>
	        <field name="header_line" eval="False"/>
	        <field name="header_spacing">0</field>
	        <field name="dpi">96</field>
        </record>

        <record id="technician_action_report_saleorder" model="ir.actions.report">
            <field name="name">Technician Copy</field>
            <field name="model">vehicle.inspection</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">tk_vehicle_management.estimation_inspection_report</field>
            <field name="report_file">tk_vehicle_management.estimation_inspection_report</field>
            <field name="print_report_name">"Technician Copy"</field>
            <field name="paperformat_id" ref="custom_paperformat_quotation"/>
            <field name="binding_model_id" ref="model_vehicle_inspection"/>
            <field name="binding_type">report</field>
        </record>
    </data>
</odoo>